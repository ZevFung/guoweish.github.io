var width=1E3,height=600,margin=50,commasFormatter=d3.format(",.0f"),xScale=d3.scale.linear().domain([100,12E3]).rangeRound([margin,width-margin]),yScale=d3.scale.log().domain([.5,200]).rangeRound([height-margin,margin]),rScale=d3.scale.linear().domain([0,18E5]).rangeRound([15,100]),color=d3.scale.category10(),colorScale=d3.scale.linear().domain([2E4,4E5,1E6,16E5]).range(["#2E8ECE","#40D47E","#E98B39","#D14233"]),xAxis=d3.svg.axis().scale(xScale).orient("bottom").tickFormat(function(b){return b+" \u4e07\u4eba"}),
yAxis=d3.svg.axis().scale(yScale).orient("left").ticks(7).tickFormat(function(b){return b}).tickValues([.5,35,70,100,135,170,200]),div=d3.select("body").append("div").attr("class","tooltip").style("opacity",0);svg=d3.select("body").select("#d3").append("svg").attr("width",width).attr("height",height).attr("viewBox",function(b){return"0,0,"+width+","+height});svg.append("g").attr("class","axis").attr("transform",function(){return"translate(0, "+height/2+")"}).call(xAxis);
svg.append("g").attr("class","axis").attr("transform",function(){return"translate("+margin+", 0)"}).call(yAxis);svg.append("g").append("text").text("2014\u5e74\u5168\u56fd\u5404\u7701\u4e58\u7528\u8f66\u4e0a\u724c\u91cf\u6bd4\u8f83").attr("x",15).attr("y",20);
d3.json("data/works-bubble.json",function(b){svg.selectAll("text.label").data(b).enter().append("text").attr("class","label").text(function(a){return a.province}).attr("style","text-anchor:middle").attr("x",function(a){return xScale(a.people)}).attr("y",function(a){return yScale(a.land)});svg.selectAll("circle").data(b).enter().append("circle").attr("class","bubble").style("stroke",function(a){return colorScale(a.car)}).style("fill",function(a){return colorScale(a.car)}).attr("cx",function(a){return xScale(a.people)}).attr("cy",
function(a){return yScale(a.land)}).attr("r",function(a){return rScale(a.car)}).on("mouseover",function(a){div.transition().duration(200).style("opacity",.5);div.html(a.car+"\u8f86<br/>"+a.province).style("left",d3.event.pageX+"px").style("top",d3.event.pageY-28+"px")}).on("mouseout",function(a){div.transition().duration(500).style("opacity",0)})});
